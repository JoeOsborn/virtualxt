#!/bin/sh

HERE="$(dirname "$(readlink -f "$0")")"
LIBS_PATH="$HERE/usr/lib:$HERE/usr/lib/x86_64-linux-gnu"

if [ -z "$LD_LIBRARY_PATH" ]; then
  LD_LIBRARY_PATH="$LIBS_PATH"
else
  LD_LIBRARY_PATH="$LIBS_PATH:$LD_LIBRARY_PATH"
fi

export LD_LIBRARY_PATH

mkdir -p $HOME/.virtualxt/boot
cp -n $HERE/boot/freedos.img $HOME/.virtualxt/boot/

export VXT_DEFAULT_BIOS_PATH=$HERE/bios/pcxtbios.bin
export VXT_DEFAULT_VIDEO_BIOS_PATH=$HERE/bios/ati_ega_wonder_800_plus.bin
export VXT_DEFAULT_FLOPPY_IMAGE=$HOME/.virtualxt/boot/freedos.img

exec "$HERE/virtualxt" "$@"